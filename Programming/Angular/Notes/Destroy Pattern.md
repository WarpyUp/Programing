Destroy - це моя назва патерну який використовується для того, щоб вимкнути підписку після того, як компонент знищується, щоб не було memory leak.

Цей підхід вважається золотим стандартом для керування підписками всередині компонентів. 
Але якщо ви використовуєте `Observable` прямо в HTML-шаблоні, краще використати [[Async Pipe]].

Давайте розберемо Destroy Pattern на три складові.

## Рубильник: 

```ts
private destroy$ = new Subject<void>();
```

- [[Subject]] — це особливий тип [[Observable]], яким ми можемо керувати вручну. Ми можемо сказати йому, коли видати нове значення, викликавши `.next()`.
- Ми створюємо "канал" або "рубильник" під назвою `destroy$`. Протягом усього життя компонента цей канал мовчить.

## Вухо: 

```ts
takeUntil(this.destroy$)
```

- **`takeUntil`** — це [[Operators|оператор]] RxJS, який, наче шпигун, слухає одразу два потоки: основний (наприклад, `onClose`) і наш "рубильник" (`destroy$`).
- **Його логіка:** "Я буду пропускати всі значення з основного потоку доти, доки не почую будь-який сигнал від `destroy$`. Як тільки `destroy$` щось видасть, я негайно і назавжди закрию основний потік і відпишусь від нього".
Використовується всередині `.pipe`.

## Момент вимкнення:

`ngOnDestroy` — це метод життєвого циклу Angular, який гарантовано викликається за мить до того, як компонент буде знищено (наприклад, коли ви переходите на іншу сторінку). Це ідеальне місце для прибирання.

```ts
ngOnDestroy() {
  this.destroy$.next();     
  // посилаємо сигнал по нашому каналу.
  this.destroy$.complete(); 
  // Повністю закриваємо сам "рубильник"
}
```

Коли `ngOnDestroy` спрацьовує, "рубильник" `destroy$` видає сигнал. Всі підписки в компоненті, у яких є `.pipe(takeUntil(this.destroy$))`, чують цей сигнал і негайно завершують свою роботу.

**Перевага:** Вам потрібен лише один `destroy$` на весь компонент, і ви можете застосувати `takeUntil` до десятків різних підписок. Це дуже чисто і масштабовано.

До появи `takeUntil` використовувася звичайний `.unsubscribe` для всіх Observable в методі `ngOnDestroy()` Він працює, але є більш громіздким і схильним до помилок.

